# å‰ç«¯è¿è§„é¡µé¢è½¦ä¸»ä¿¡æ¯ä¼˜åŒ–è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æ ¹æ®åç«¯æ¥å£çš„ä¼˜åŒ–ï¼Œå‰ç«¯è¿è§„é¡µé¢ç°åœ¨æ”¯æŒåŒºåˆ†ä¸‰ç§è½¦ä¸»ç±»å‹ï¼š
- **æœ¬åœ°è½¦ä¸»** (`ownerType: 'local'`) - åœ¨è¿è§„è®°å½•ä¸­åªæœ‰ `owner_id`
- **æœˆç¥¨è½¦ä¸»** (`ownerType: 'monthly'`) - åœ¨è¿è§„è®°å½•ä¸­åªæœ‰ `month_ticket_id` 
- **é¢„çº¦è½¦è¾†** (`ownerType: 'unknown'`) - åœ¨è¿è§„è®°å½•ä¸­æ—¢æ²¡æœ‰ `owner_id` ä¹Ÿæ²¡æœ‰ `month_ticket_id`

## ğŸ”§ ä¿®æ”¹å†…å®¹

### 1. æ¥å£æ•°æ®ç»“æ„é€‚é…

#### åç«¯å“åº”ç¤ºä¾‹
```json
{
  "severity": "moderate",
  "ownerType": "monthly",
  "isNewEnergy": 0,
  "ownerPhone": "13904656840",
  "parkName": "å››å­£ä¸Šä¸œ",
  "description": "è½¦ç‰Œè¢«é®æŒ¡ï¼Œæ— æ³•æ­£å¸¸è¯†åˆ«",
  "remark": "è½¦ç‰Œè¢«é®æŒ¡ï¼Œæ— æ³•æ­£å¸¸è¯†åˆ«",
  "plateNumber": "é»‘AFB2588",
  "photos": "[\"http://tmp/55l6JaQMnDYB21f2425524048d53aa71cdbebf23edee.png\"]",
  "createdAt": 1755330566000,
  "monthTicketName": "å››å­£ä¸Šä¸œäºŒæœŸ",
  "violationType": "é®æŒ¡è½¦ç‰Œ",
  "appointmentTime": "2025-08-16 07:49:26",
  "ownerName": "ç‹å˜‰è¯š15-3-3901",
  "statusText": "å¾…å¤„ç†",
  "monthTicketStatus": 1,
  "location": "æµ‹è¯•ä½ç½®",
  "id": 23,
  "ownerAddress": "å››å­£ä¸Šä¸œåœè½¦åœºæœˆç¥¨è½¦ä¸»",
  "status": "pending"
}
```

#### å‰ç«¯æ•°æ®æ˜ å°„
```javascript
// åœ¨ loadRealtimeViolations æ–¹æ³•ä¸­
this.realtimeRecords = records.map(item => ({
    id: item.id,
    plateNumber: item.plateNumber || item.plate_number,
    violationType: item.violationType || item.violation_type,
    // ... åŸºç¡€å­—æ®µ ...
    
    // æ–°å¢ï¼šè½¦ä¸»ç±»å‹ç›¸å…³ä¿¡æ¯
    ownerType: item.ownerType || 'unknown',
    // æœˆç¥¨è½¦ä¸»ä¸“å±ä¿¡æ¯
    monthTicketName: item.monthTicketName || '',
    parkName: item.parkName || '',
    monthTicketStatus: item.monthTicketStatus || 0,
    // æœ¬åœ°è½¦ä¸»ä¸“å±ä¿¡æ¯
    community: item.community || '',
    creditScore: item.creditScore || null,
    // ... å…¶ä»–å­—æ®µ ...
}));
```

### 2. ç•Œé¢æ˜¾ç¤ºä¼˜åŒ–

#### è½¦ä¸»ç±»å‹æ ‡è¯†
- **æœ¬åœ°è½¦ä¸»**: ğŸ  ç»¿è‰²æ ‡ç­¾ï¼Œæ˜¾ç¤º "æœ¬åœ°è½¦ä¸»"
- **æœˆç¥¨è½¦ä¸»**: ğŸ« è“è‰²æ ‡ç­¾ï¼Œæ˜¾ç¤º "æœˆç¥¨è½¦ä¸»" 
- **é¢„çº¦è½¦è¾†**: ğŸš— æ©™è‰²æ ‡ç­¾ï¼Œæ˜¾ç¤º "é¢„çº¦è½¦è¾†"

#### è½¦ä¸»ä¿¡æ¯æ˜¾ç¤ºé€»è¾‘
```javascript
// è·å–è½¦ä¸»åœ°å€æ–‡æœ¬
getOwnerAddressText(car) {
    if (car.ownerType === 'monthly') {
        return car.parkName ? `${car.parkName}æœˆç¥¨è½¦ä¸»` : 'æœªçŸ¥è½¦åœº';
    } else if (car.ownerType === 'local') {
        return car.address || 'æœªçŸ¥åœ°å€';
    } else {
        return 'é¢„çº¦è®¿å®¢è½¦è¾†';
    }
}
```

### 3. ä¸“å±ä¿¡æ¯æ˜¾ç¤º

#### æœˆç¥¨è½¦ä¸»ä¸“å±ä¿¡æ¯
- æœˆç¥¨åç§°
- è½¦åœºåç§°  
- æœˆç¥¨çŠ¶æ€ï¼ˆæœ‰æ•ˆ/æ— æ•ˆï¼‰

```vue
<view v-if="car.ownerType === 'monthly'" class="monthly-info">
    <view class="info-row">
        <view class="info-item">
            <text class="label">æœˆç¥¨åç§°</text>
            <text class="value">{{ car.monthTicketName || 'æœªçŸ¥' }}</text>
        </view>
        <view class="info-item">
            <text class="label">è½¦åœºåç§°</text>
            <text class="value">{{ car.parkName || 'æœªçŸ¥' }}</text>
        </view>
    </view>
    <view class="info-row">
        <view class="info-item">
            <text class="label">æœˆç¥¨çŠ¶æ€</text>
            <view class="status-indicator" :class="car.monthTicketStatus === 1 ? 'active' : 'inactive'">
                <text class="status-text">{{ car.monthTicketStatus === 1 ? 'æœ‰æ•ˆ' : 'æ— æ•ˆ' }}</text>
            </view>
        </view>
    </view>
</view>
```

#### æœ¬åœ°è½¦ä¸»ä¸“å±ä¿¡æ¯
- å°åŒºåç§°
- ä¿¡ç”¨åˆ†æ•°

```vue
<view v-if="car.ownerType === 'local'" class="local-owner-info">
    <view class="info-row">
        <view class="info-item" v-if="car.community">
            <text class="label">å°åŒº</text>
            <text class="value">{{ car.community }}</text>
        </view>
        <view class="info-item" v-if="car.creditScore">
            <text class="label">ä¿¡ç”¨åˆ†æ•°</text>
            <text class="value score" :class="getCreditScoreClass(car.creditScore)">
                {{ car.creditScore }}
            </text>
        </view>
    </view>
</view>
```

#### é¢„çº¦è½¦è¾†ä¿¡æ¯
- æ˜¾ç¤ºæç¤ºæ–‡æœ¬ï¼šè¯¥è½¦è¾†ä¸ºé¢„çº¦è®¿å®¢è½¦è¾†æˆ–æ— è½¦ä¸»ä¿¡æ¯

```vue
<view v-if="car.ownerType === 'unknown' || !car.ownerType" class="visitor-info">
    <view class="info-row">
        <text class="visitor-tip">è¯¥è½¦è¾†ä¸ºé¢„çº¦è®¿å®¢è½¦è¾†æˆ–æ— è½¦ä¸»ä¿¡æ¯</text>
    </view>
</view>
```

### 4. æ ·å¼è®¾è®¡

#### è½¦ä¸»ç±»å‹æ ‡ç­¾æ ·å¼
```css
.type-tag.type-local {
    background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
    color: white;
}

.type-tag.type-monthly {
    background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
    color: white;
}

.type-tag.type-visitor {
    background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
    color: white;
}
```

#### ä¿¡ç”¨åˆ†æ•°é¢œè‰²åŒºåˆ†
```css
.score.score-excellent { background: #4CAF50; } /* 90+ ä¼˜ç§€ */
.score.score-good { background: #8BC34A; }      /* 80-89 è‰¯å¥½ */
.score.score-normal { background: #FF9800; }    /* 70-79 ä¸€èˆ¬ */
.score.score-poor { background: #F44336; }      /* <70 è¾ƒå·® */
```

#### æœˆç¥¨çŠ¶æ€æŒ‡ç¤ºå™¨
```css
.status-indicator.active {
    background: #4CAF50;
    color: white;
}

.status-indicator.inactive {
    background: #F44336;
    color: white;
}
```

### 5. æ–°å¢çš„å·¥å…·æ–¹æ³•

```javascript
// è·å–è½¦ä¸»ç±»å‹æ ·å¼ç±»
getOwnerTypeClass(ownerType) {
    switch(ownerType) {
        case 'local': return 'type-local';
        case 'monthly': return 'type-monthly';
        case 'unknown':
        default: return 'type-visitor';
    }
}

// è·å–è½¦ä¸»ç±»å‹å›¾æ ‡
getOwnerTypeIcon(ownerType) {
    switch(ownerType) {
        case 'local': return 'ğŸ ';
        case 'monthly': return 'ğŸ«';
        case 'unknown':
        default: return 'ğŸš—';
    }
}

// è·å–è½¦ä¸»ç±»å‹æ–‡æœ¬
getOwnerTypeText(ownerType) {
    switch(ownerType) {
        case 'local': return 'æœ¬åœ°è½¦ä¸»';
        case 'monthly': return 'æœˆç¥¨è½¦ä¸»';
        case 'unknown':
        default: return 'é¢„çº¦è½¦è¾†';
    }
}

// è·å–ä¿¡ç”¨åˆ†æ•°æ ·å¼ç±»
getCreditScoreClass(score) {
    if (score >= 90) return 'score-excellent';
    if (score >= 80) return 'score-good';
    if (score >= 70) return 'score-normal';
    return 'score-poor';
}
```

## ğŸ¯ æ˜¾ç¤ºæ•ˆæœ

### æœ¬åœ°è½¦ä¸»è¿è§„è®°å½•
- ğŸ  æœ¬åœ°è½¦ä¸»ï¼ˆç»¿è‰²æ ‡ç­¾ï¼‰
- æ˜¾ç¤ºä¸šä¸»å§“åã€è”ç³»ç”µè¯ã€è¯¦ç»†åœ°å€
- æ˜¾ç¤ºå°åŒºåç§°ã€ä¿¡ç”¨åˆ†æ•°
- ä¿¡ç”¨åˆ†æ•°æœ‰é¢œè‰²åŒºåˆ†ï¼ˆ90+ç»¿è‰²ï¼Œ80-89æµ…ç»¿ï¼Œ70-79æ©™è‰²ï¼Œ<70çº¢è‰²ï¼‰

### æœˆç¥¨è½¦ä¸»è¿è§„è®°å½•  
- ğŸ« æœˆç¥¨è½¦ä¸»ï¼ˆè“è‰²æ ‡ç­¾ï¼‰
- æ˜¾ç¤ºè½¦ä¸»å§“åã€è”ç³»ç”µè¯ã€è½¦åœºä¿¡æ¯
- æ˜¾ç¤ºæœˆç¥¨åç§°ã€è½¦åœºåç§°ã€æœˆç¥¨çŠ¶æ€
- æœˆç¥¨çŠ¶æ€ï¼šæœ‰æ•ˆï¼ˆç»¿è‰²ï¼‰/æ— æ•ˆï¼ˆçº¢è‰²ï¼‰

### é¢„çº¦è®¿å®¢è½¦è¾†è¿è§„è®°å½•
- ğŸš— é¢„çº¦è½¦è¾†ï¼ˆæ©™è‰²æ ‡ç­¾ï¼‰  
- æ˜¾ç¤ºæç¤ºï¼šè¯¥è½¦è¾†ä¸ºé¢„çº¦è®¿å®¢è½¦è¾†æˆ–æ— è½¦ä¸»ä¿¡æ¯
- èƒŒæ™¯ä¸ºæ©™è‰²æ¸å˜ï¼Œçªå‡ºæ˜¾ç¤º

## âœ… å…¼å®¹æ€§è¯´æ˜

1. **å‘åå…¼å®¹**: å¦‚æœåç«¯æœªè¿”å› `ownerType` å­—æ®µï¼Œé»˜è®¤ä¸º `'unknown'`
2. **å­—æ®µå…¼å®¹**: æ”¯æŒæ–°æ—§å­—æ®µåçš„æ˜ å°„ï¼ˆå¦‚ `plateNumber` å’Œ `plate_number`ï¼‰
3. **ç©ºå€¼å¤„ç†**: æ‰€æœ‰å­—æ®µéƒ½æœ‰é»˜è®¤å€¼ï¼Œé¿å…æ˜¾ç¤º `null` æˆ– `undefined`

## ğŸš€ æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹
1. **æœ¬åœ°è½¦ä¸»**: éªŒè¯æ˜¾ç¤ºç»¿è‰²æ ‡ç­¾ã€å°åŒºä¿¡æ¯ã€ä¿¡ç”¨åˆ†æ•°
2. **æœˆç¥¨è½¦ä¸»**: éªŒè¯æ˜¾ç¤ºè“è‰²æ ‡ç­¾ã€æœˆç¥¨ä¿¡æ¯ã€è½¦åœºåç§°
3. **é¢„çº¦è½¦è¾†**: éªŒè¯æ˜¾ç¤ºæ©™è‰²æ ‡ç­¾ã€è®¿å®¢æç¤ºä¿¡æ¯
4. **æ•°æ®ç¼ºå¤±**: éªŒè¯å­—æ®µä¸ºç©ºæ—¶çš„é»˜è®¤æ˜¾ç¤º

### éªŒè¯è¦ç‚¹
- è½¦ä¸»ç±»å‹æ ‡ç­¾æ˜¯å¦æ­£ç¡®æ˜¾ç¤º
- ä¸“å±ä¿¡æ¯æ˜¯å¦æ ¹æ®ç±»å‹æ˜¾ç¤º/éšè—
- æ ·å¼æ˜¯å¦æ­£ç¡®åº”ç”¨
- è¾¹ç•Œæƒ…å†µæ˜¯å¦æ­£å¸¸å¤„ç†

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åŒæ­¥**: ç¡®ä¿åç«¯è¿”å›å®Œæ•´çš„è½¦ä¸»ç±»å‹ä¿¡æ¯
2. **æ€§èƒ½ä¼˜åŒ–**: é¿å…åœ¨æ¨¡æ¿ä¸­è¿›è¡Œå¤æ‚çš„è®¡ç®—
3. **ç”¨æˆ·ä½“éªŒ**: ä¸åŒè½¦ä¸»ç±»å‹æœ‰æ˜æ˜¾çš„è§†è§‰åŒºåˆ†
4. **é”™è¯¯å¤„ç†**: å½“æ•°æ®å¼‚å¸¸æ—¶æœ‰åˆç†çš„é™çº§æ˜¾ç¤º

é€šè¿‡è¿™äº›ä¼˜åŒ–ï¼Œç”¨æˆ·å¯ä»¥ä¸€ç›®äº†ç„¶åœ°è¯†åˆ«è¿è§„è½¦è¾†çš„è½¦ä¸»ç±»å‹ï¼Œå¹¶è·å–ç›¸åº”çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¤§å¤§æå‡äº†è¿è§„ç®¡ç†çš„æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚ 