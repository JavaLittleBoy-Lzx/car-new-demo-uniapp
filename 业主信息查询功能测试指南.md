# 业主信息查询功能测试指南

## 测试环境准备

### 1. 数据准备
确保数据库中有以下测试数据：

```sql
-- 业主信息表 (ownerinfo)
INSERT INTO ownerinfo (province, city, district, community, building, units, floor, roomnumber, ownername, ownerphone, isaudit) VALUES
('黑龙江省', '哈尔滨市', '南岗区', '四季上东', '1', 1, 1, 101, '张三', '13800138001', '1'),
('黑龙江省', '哈尔滨市', '南岗区', '四季上东', '1', 1, 1, 102, '李四', '13800138002', '1'),
('黑龙江省', '哈尔滨市', '南岗区', '四季上东', '1', 1, 2, 201, '王五', '13800138003', '0'),
('黑龙江省', '哈尔滨市', '南岗区', '四季上东', '2', 1, 1, 101, '赵六', '13800138004', '1');
```

### 2. 用户权限
- 确保测试用户具有管家权限 (role = 'manager')
- 确保用户已完成手机号验证

## 功能测试用例

### 测试用例1：基础业主查询功能

**测试步骤：**
1. 登录管家账号
2. 进入二维码生成页面 (`pagesB/butler/qrcode-generator.vue`)
3. 依次选择：省份 → 城市 → 区县 → 社区
4. 观察业主选择器是否出现

**预期结果：**
- 选择社区后，业主选择器显示
- 显示"选择业主信息"标题
- 自动查询并显示该社区的所有业主
- 显示业主数量统计

### 测试用例2：地址层级筛选

**测试步骤：**
1. 在已选择社区的基础上
2. 继续选择楼栋
3. 观察业主列表变化
4. 继续选择单元、楼层
5. 观察每次选择后的业主列表变化

**预期结果：**
- 每次地址选择后，业主列表自动更新
- 只显示符合当前地址条件的业主
- 地址越详细，业主列表越精确

### 测试用例3：业主搜索功能

**测试步骤：**
1. 在业主列表显示的情况下
2. 在搜索框中输入业主姓名（如"张三"）
3. 观察列表过滤效果
4. 清除搜索内容
5. 输入手机号进行搜索

**预期结果：**
- 输入姓名时，只显示匹配的业主
- 输入手机号时，只显示匹配的业主
- 清除搜索后，显示所有业主
- 搜索是实时的，无需点击搜索按钮

### 测试用例4：业主选择和地址自动填充

**测试步骤：**
1. 在业主列表中点击选择一个业主
2. 观察业主是否被选中（蓝色边框和勾选图标）
3. 观察地址选择器的变化
4. 查看"已选择业主"预览区域
5. 查看"访问地址预览"区域

**预期结果：**
- 业主被选中，有视觉反馈
- 地址选择器自动填充业主的完整地址信息
- "已选择业主"区域显示业主详细信息
- "访问地址预览"显示完整地址

### 测试用例5：地址变更时的业主清除

**测试步骤：**
1. 选择一个业主
2. 重新选择不同的社区
3. 观察业主选择是否被清除
4. 重新选择不同的楼栋
5. 观察业主选择是否被清除

**预期结果：**
- 地址变更时，之前的业主选择被清除
- 业主列表重新查询
- "已选择业主"预览消失

### 测试用例6：无业主数据处理

**测试步骤：**
1. 选择一个没有业主数据的地址
2. 观察页面显示

**预期结果：**
- 显示"该地址暂无业主信息"提示
- 提供友好的解决建议
- 不显示业主列表

### 测试用例7：网络异常处理

**测试步骤：**
1. 断开网络连接
2. 尝试查询业主信息
3. 观察错误处理

**预期结果：**
- 显示网络错误提示
- 不会导致页面崩溃
- 提供重试机制

## 性能测试

### 测试用例8：大量业主数据处理

**测试步骤：**
1. 准备包含100+业主的社区数据
2. 选择该社区
3. 观察加载时间和页面响应

**预期结果：**
- 加载时间在3秒内
- 页面滚动流畅
- 搜索响应及时

## 兼容性测试

### 测试用例9：不同设备适配

**测试设备：**
- iPhone (iOS)
- Android 手机
- 微信开发者工具

**测试内容：**
- 业主列表显示正常
- 搜索框功能正常
- 选择操作响应正常
- 样式显示正确

## 数据验证

### 测试用例10：API数据格式验证

**验证内容：**
1. 检查API返回的业主数据格式
2. 验证必要字段是否存在
3. 验证数据类型是否正确

**关键字段：**
- `id`: 业主ID
- `ownername`: 业主姓名
- `ownerphone`: 业主电话
- `province`, `city`, `district`, `community`: 地址信息
- `building`, `units`, `floor`, `roomnumber`: 详细地址
- `isaudit`: 审核状态

## 错误场景测试

### 测试用例11：异常数据处理

**测试场景：**
1. 业主姓名为空
2. 业主电话为空
3. 地址信息不完整
4. 审核状态异常值

**预期结果：**
- 显示默认值（如"未知业主"）
- 不会导致页面错误
- 保持功能可用性

## 测试检查清单

- [ ] 业主查询功能正常
- [ ] 搜索功能正常
- [ ] 业主选择功能正常
- [ ] 地址自动填充正常
- [ ] 地址变更时清除业主选择
- [ ] 无数据时显示友好提示
- [ ] 加载状态显示正常
- [ ] 错误处理正常
- [ ] 样式显示正确
- [ ] 性能表现良好
- [ ] 兼容性良好

## 常见问题排查

### 问题1：业主列表不显示
- 检查社区是否已选择
- 检查API接口是否正常
- 检查数据库中是否有对应业主数据

### 问题2：搜索功能不工作
- 检查搜索关键词是否正确
- 检查业主数据中的姓名和电话字段

### 问题3：地址自动填充不工作
- 检查业主数据中的地址字段是否完整
- 检查 `autoFillAddressFromOwner` 方法是否正确调用

### 问题4：样式显示异常
- 检查CSS样式是否正确加载
- 检查uView组件是否正常工作
