# 摄像头自动识别功能说明

## 功能概述
在原有的手动拍照识别基础上，新增了摄像头自动识别功能，让用户能够自动连续识别车牌，无需手动点击拍照按钮。

## 主要特性

### 1. 自动识别模式
- **自动拍照**: 每3秒自动拍照一次进行车牌识别
- **连续识别**: 持续监控直到识别成功或用户停止
- **智能提示**: 识别成功后询问是否继续或停止

### 2. 智能防抖机制
- **时间防抖**: 确保两次识别间隔至少2秒
- **状态防抖**: 正在识别时跳过新的识别请求
- **自动跳过**: 避免过于频繁的API调用

### 3. 用户界面优化
- **状态指示器**: 右上角显示自动识别状态和次数
- **动态提示**: 扫描框内文字根据模式变化
- **按钮状态**: 自动识别时禁用手动拍照按钮

## 使用方法

### 启动自动识别
1. 点击"摄像头识别"按钮
2. 在弹出的询问框中选择"开启"自动识别
3. 或者在摄像头界面点击"自动识别"按钮（▶️图标）

### 停止自动识别
1. 点击"停止自动"按钮（⏸️图标）
2. 或者在识别成功提示框中选择"停止"
3. 关闭摄像头会自动停止

### 手动模式
- 在摄像头界面如果没有开启自动识别
- 可以继续使用"手动拍照"按钮（📷图标）
- 自动识别开启时手动按钮会被禁用

## 界面元素说明

### 按钮状态
- **▶️ 自动识别**: 橙色按钮，点击开启自动识别
- **⏸️ 停止自动**: 绿色按钮，带脉冲动画，点击停止自动识别
- **📷 手动拍照**: 蓝色按钮，自动识别时禁用（灰色）
- **❌ 关闭摄像头**: 红色按钮，关闭摄像头并停止所有识别

### 状态指示器
位于摄像头界面右上角，显示：
- 🟢 绿色脉冲点：表示自动识别活跃
- 次数计数：显示已执行的识别次数

### 扫描框提示
- 普通模式：`请将车牌对准框内`
- 自动模式：`自动识别中，请保持稳定`

## 技术实现

### 核心功能
```javascript
// 自动识别相关数据
autoRecognize: false,        // 自动识别开关
autoRecognizeTimer: null,    // 自动识别定时器
autoRecognizeCount: 0,       // 自动识别次数计数
autoRecognizeInterval: 3000, // 自动识别间隔（3秒）
lastRecognizeTime: 0         // 上次识别时间（防抖用）
```

### 关键方法
- `startAutoRecognize()`: 开启自动识别
- `stopAutoRecognize()`: 停止自动识别
- `performAutoRecognize()`: 执行单次自动识别
- `autoCapture()`: 自动拍照（区别于手动拍照）
- `scheduleNextAutoRecognize()`: 调度下次识别

### 防抖机制
1. **状态检查**: 识别进行中时跳过新请求
2. **时间间隔**: 确保最小2秒间隔
3. **自动跳过**: 记录跳过原因到控制台

## 用户体验优化

### 识别成功处理
- **自动模式**: 显示简短提示，询问是否继续
- **手动模式**: 关闭摄像头，显示详细结果

### 识别失败处理
- **自动模式**: 静默处理，继续下次识别
- **手动模式**: 显示错误提示

### API调用优化
- **超时时间**: 自动识别使用15秒超时，手动识别30秒
- **调试模式**: 不影响自动识别的正常运行
- **日志记录**: 区分自动和手动识别的日志

## 使用场景

### 适用场景
- 停车场入口连续监控
- 批量车牌录入
- 不方便手动操作的环境
- 提高识别效率

### 注意事项
- 保持设备稳定，避免剧烈晃动
- 确保光线充足
- 车牌尽量保持在识别框内
- 网络连接稳定

## 升级说明

### 新增功能
1. ✅ 自动识别开关
2. ✅ 定时器机制
3. ✅ 防抖保护
4. ✅ 状态指示器
5. ✅ 智能提示

### 保持兼容
- 原有手动识别功能完全保留
- 相册识别功能不受影响
- 调试模式正常工作
- API接口保持不变

### 使用指南更新
更新了使用说明，新增步骤：
1. 点击"摄像头识别"启动实时扫描
2. **选择"自动识别"或"手动拍照"模式**
3. 将车牌对准扫描框内保持稳定
4. **自动模式每3秒识别一次，手动模式点击拍照**
5. 也可选择从相册中选择图片识别

这样，用户可以根据实际需求选择最适合的识别方式，大大提升了使用体验和识别效率。 