# 车牌识别功能最新测试说明

## 修复完成 ✅

根据百度AI官方文档，我们已经修复了以下问题：

1. ✅ **216201错误**：移除了不支持的`detectDirection`字段
2. ✅ **字段名匹配**：前端`multiDetect`正确映射到后端`multi_detect`
3. ✅ **概率解析**：修正了`probability`数组的解析逻辑
4. ✅ **API参数**：使用百度官方文档的正确参数格式

## 立即测试步骤

### 1. 确认后端服务运行
```bash
cd parking-demo
mvn spring-boot:run
```

**确认日志显示服务启动在端口8543**

### 2. 小程序端测试

1. **进入测试页面**
   - 点击违规页面的"🎯 车牌识别测试"按钮
   - 或直接访问：`pages/demo/plate-scanner`

2. **测试摄像头识别**
   - 点击"📷 摄像头识别"
   - 对准包含车牌的图片或屏幕
   - 点击拍照按钮

3. **测试相册选择**
   - 点击"🖼️ 相册选择"
   - 选择包含车牌的图片

### 3. 查看识别结果

正常情况下应该看到：
```
车牌号码: 川A12345
颜色: blue  
置信度: 95.8%
识别时间: 2025-06-28 15:30:25
```

### 4. 调试信息查看

**前端调试**：
- 打开微信开发者工具控制台
- 查看`车牌识别响应`日志

**后端调试**：
- 查看后端控制台日志
- 确认看到成功的API调用记录

## 错误排查

### 如果仍然出现216201错误

1. **检查图片格式**
   ```bash
   # 确保图片是以下格式之一
   - JPG/JPEG
   - PNG  
   - BMP
   ```

2. **检查图片大小**
   - Base64编码后应小于8MB
   - 图片最短边至少15px，最长边最大4096px

3. **检查API密钥配置**
   ```yaml
   # application.yml
   baidu:
     ai:
       api-key: "your_actual_api_key"
       secret-key: "your_actual_secret_key"
   ```

### 如果未检测到车牌

1. **确保图片质量**
   - 车牌清晰可见
   - 光线充足
   - 角度适中

2. **尝试多张测试图片**
   - 使用不同角度的车牌图片
   - 确保车牌号码完整显示

## 支持的车牌类型

根据百度AI文档，支持识别：
- 🚗 蓝牌（普通车辆）
- 🚛 黄牌（单双行）
- 🔋 绿牌（新能源）  
- 🚌 黄绿牌（大型新能源）
- 🏛️ 领使馆车牌
- 👮 警牌、武警牌
- 🪖 军牌
- 🌏 港澳出入境车牌
- 🚜 农用车牌
- ✈️ 民航车牌

## API调用示例

**请求**：
```json
{
  "image": "base64_encoded_image_data",
  "multiDetect": false
}
```

**响应**：
```json
{
  "success": true,
  "data": {
    "plateNumber": "川A12345",
    "color": "blue",
    "confidence": 95.8,
    "source": "baidu_ai"
  }
}
```

## 联系支持

如果测试仍有问题，请提供：
1. 前端控制台日志截图
2. 后端服务日志
3. 测试使用的图片（脱敏处理）
4. 错误信息详情

---

**更新时间**: 2025-06-28  
**状态**: ✅ 已修复，可正常使用 